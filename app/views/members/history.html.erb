<%= render 'header' %>

  <div class="container">
    <% flash.each_with_index do |(key, message), index| %>
      <div class="notification is-<%= key %>" id="<%= key %>-<%= index %>">
        <button class="delete" onclick="document.getElementById('<%= key %>-<%= index %>').style.display = 'none'"></button>
        <%= raw(message) %>
      </div>
      <% end %>
  </div>

  <section class="section">
    <div class="container">
      <table id="loan_history" class=" table is-hoverable is-fullwidth is-responsive">
        <thead>
          <th class="is-narrow">&nbsp;</th>
          <th class="has-text-grey-dark has-text-weight-semibold item_name">
            Item
          </th>
          <th class="has-text-grey-dark has-text-weight-semibold ">
            Serial Number
          </th>
          <th class="has-text-grey-dark has-text-weight-semibold ">
            Inventory Tag
          </th>
          <th class="has-text-grey-dark has-text-weight-semibold">
            Borrowed
          </th>
          <th class="has-text-grey-dark has-text-weight-semibold">
            Returned
          </th>
          <th class="has-text-grey-dark has-text-weight-semibold is-hidden-touch">
            Duration
          </th>
        </thead>
        <tbody>
          <% @loans.each do |loan| -%>
            <tr>
              <td class="has-text-centered is-narrow" style="padding-left: 0px; padding-right: 0px"><i class="<%= loan.item.category.icon %>"></i></td>
              <td style="padding-left: .5em;">
                <span class="item_name">
                  <%= link_to item_path(loan.item.id) do %>
                    <%= loan.item.full_name %>
                  <% end %>
                </span>
              </td>
              <td class="is-monospaced">
                <%= loan.item.serial_number %>
              </td>
              <td class="is-monospaced">
                <%= loan.item.inventory_tag %>
              </td>
              <td class="is-monospaced">
                <%= local_time_ago(loan.created_at) %>
              </td>
                <% if loan.returned_at %>
              <td class="is-monospaced">
                <%= local_time_ago(loan.returned_at) %>
              </td>
                <% else %>
              <td class="is-monospaced">
                  -
              </td>
                <% end %>
              <td class="is-hidden-touch is-monospaced">
                <%= loan.days_borrowed %>
              </td>
            </tr>
            <% end -%>
        </tbody>
      </table>
    <!-- Main container -->
    <div class="columns">
      <div class="column is-one-fourth">
        <%== pagy_info(@pagy) %>
      </div>

      <div class="column is-narrow">
        <%== pagy_bulma_nav(@pagy) %>
      </div>
    </div>
  </section>